<Window x:Class="SCQueryConnect.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:SQLUpdate"
        mc:Ignorable="d" Background="#00AFFC"
        Closing="MainWindow_OnClosing"
        Title="SharpCloud QueryConnect v1.01" Height="350" Width="625" Icon="favicon.ico" ResizeMode="CanResizeWithGrip">
    <Grid>
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="30"></RowDefinition>
                <RowDefinition Height="20"></RowDefinition>
                <RowDefinition Height="5*"></RowDefinition>
                <RowDefinition Height="20"></RowDefinition>
                <RowDefinition Height="5*"></RowDefinition>
                <RowDefinition Height="20"></RowDefinition>
                <RowDefinition Height="2*"></RowDefinition>
                <RowDefinition Height="20"></RowDefinition>
                <RowDefinition Height="2*" MinHeight="40"></RowDefinition>
            </Grid.RowDefinitions>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="140"></ColumnDefinition>
                <ColumnDefinition Width="*"></ColumnDefinition>
            </Grid.ColumnDefinitions>
            <TextBlock Grid.Row="0" Grid.Column="0" Text="DB Connection String:" TextAlignment="Right" Margin="5"></TextBlock>
            <ComboBox x:Name="cbDatabase" Grid.Row="0" Grid.Column="1" Width="100" Margin="5" HorizontalAlignment="Left" Text="Connection Type">
                <ComboBoxItem>MSSQL</ComboBoxItem>
                <ComboBoxItem>ODBC</ComboBoxItem> 
                <ComboBoxItem>ADO</ComboBoxItem>
            </ComboBox>
            <TextBox x:Name="ConnectionString" Grid.Row="0" Grid.Column="1" Text="Server=.; Integrated Security=true; Database=demo" TextWrapping="WrapWithOverflow" Margin="110,5,5,5" FontFamily="Courier New"/>
            <GridSplitter Grid.Column="0" Grid.Row="1" Grid.ColumnSpan="2" HorizontalAlignment="Stretch" Height="5"></GridSplitter>
            <StackPanel Grid.Row="1" Grid.Column="1" Orientation="Horizontal" HorizontalAlignment="Right" Margin="5,0">
                <Button Width="105" Click="TextConnectionClick">Test Connection</Button>
            </StackPanel>
            <StackPanel Grid.Row="1" Grid.Column="1" Orientation="Horizontal" HorizontalAlignment="Left">
                <Button Width="70" Margin="5,0,0,0" Click="EgButtonClick">Example</Button>
                <Button Width="70" Margin="5,0,0,0" Click="HelpButtonClick">More Help</Button>
            </StackPanel>

            
            <GridSplitter Grid.Column="0" Grid.Row="3" Grid.ColumnSpan="2" HorizontalAlignment="Stretch" Height="5"></GridSplitter>
            <TextBlock Background="Red" Grid.Row="3" Grid.Column="1" Foreground="White" FontWeight="Bold" Text=" Error: Data must contain a 'Name' or 'External ID' column" x:Name="txterr" Margin="5,0" Visibility="Collapsed"></TextBlock>
            <TextBlock Grid.Row="2" Grid.Column="0" Text="Query String:" TextAlignment="Right" Margin="5"></TextBlock>
            <TextBox x:Name="SQLString" Grid.Row="2" Grid.Column="1" Text="SELECT * FROM TABLE" Margin="5" FontFamily="Courier New" AcceptsReturn="True" TextWrapping="WrapWithOverflow"/>
            <Button  Click="RunClick" Grid.Row="3" Grid.Column="1" HorizontalAlignment="Right" Width="120" Margin="5,0">Run (Results Below)</Button>

            <TextBlock Grid.Row="4" Grid.Column="0" Text="DB Results:" TextAlignment="Right" Margin="5"></TextBlock>
            <DataGrid x:Name="DataGrid" Grid.Row="4" Grid.Column="1" Margin="5"/>
            <GridSplitter Grid.Column="0" Grid.Row="5" Grid.ColumnSpan="2" HorizontalAlignment="Stretch" Height="5"></GridSplitter>

            <TextBlock Grid.Row="6" Grid.Column="0" Text="SharpCloud:" TextAlignment="Right" Margin="5"></TextBlock>
            <WrapPanel Grid.Row="6" Grid.Column="1" Margin="5">
                <StackPanel Orientation="Horizontal">
                    <TextBlock Text ="URL:" TextAlignment="Right" Width="100"></TextBlock>
                    <TextBox x:Name="Url" Text ="https://my.sharpcloud.com" Width="250"></TextBox>
                </StackPanel>
                <StackPanel Orientation="Horizontal">
                    <TextBlock Text ="Username:" TextAlignment="Right" Width="100"></TextBlock>
                    <TextBox x:Name="Username" Width="250"></TextBox>
                </StackPanel>
                <StackPanel Orientation="Horizontal">
                    <TextBlock Text ="Password:" TextAlignment="Right" Width="100"></TextBlock>
                    <PasswordBox x:Name="Password" Width="250"></PasswordBox>
                </StackPanel>
                <StackPanel Orientation="Horizontal">
                    <TextBlock Text ="Story ID:" TextAlignment="Right" Width="100"></TextBlock>
                    <TextBox x:Name="StoryId" Width="250"></TextBox>
                </StackPanel>
            </WrapPanel>
            <GridSplitter Grid.Column="0" Grid.Row="7" Grid.ColumnSpan="2" HorizontalAlignment="Stretch" Height="5"></GridSplitter>
            <Button Grid.Row="7" Grid.Column="1" Click="UpdateSharpCloud"  HorizontalAlignment="Right" Width="120" Margin="5,0">Update Story Now..</Button>
            <Button Grid.Row="7" Grid.Column="1" Click="GenerateBatchFile"  HorizontalAlignment="Left" Width="180" Margin="5,0">Generate Batch Files Now..</Button>

            <TextBlock Grid.Row="8" Grid.Column="0" Text="Update Results:" TextAlignment="Right" Margin="5"></TextBlock>
            <TextBox Grid.Row="8" x:Name="tbResults" Grid.Column="1" Width="Auto" Margin="5,0,5,5" TextWrapping="Wrap" AcceptsReturn="True" IsReadOnly="True" Background="#00AFFC" Foreground="#333333" > </TextBox>
            <Grid x:Name="updatingMessageGrid" Grid.RowSpan="7" Grid.ColumnSpan="2"  Background="#cc000000" Visibility="{Binding UpdatingMessageVisibility}">
                <TextBlock Foreground="white" MaxWidth="500" FontSize="30" TextWrapping="WrapWithOverflow" Text="Updating..." VerticalAlignment="Center" HorizontalAlignment="Center" ></TextBlock>
            </Grid>
        </Grid>
    </Grid>
</Window>
